<!DOCTYPE html>
<html>
<head>
    <title>NEXUS MONITORING</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { font-family: sans-serif; padding: 15px; background: #f4f7f6; }
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 14px; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #007bff; color: white; }
        .btn { background: #28a745; color: white; padding: 10px; border: none; width: 100%; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="card">
        <h3>Professor Dashboard</h3>
        <button class="btn" onclick="loadData()">ðŸ”„ Refresh Student List</button>
        <table>
            <thead>
                <tr><th>Student Name</th><th>Role</th><th>Course</th></tr>
            </thead>
            <tbody id="student-list">
                <tr><td colspan="3" style="text-align:center;">Click refresh to load...</td></tr>
            </tbody>
        </table>
    </div>
    <script>
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyNaG3UdE9Zp5UYUsMksNCGiDc-dRywbNpZHRg0kxBPtjIKEjGsuglkw0gumYCxCQ_Z/exec";
        function loadData() {
            const list = document.getElementById('student-list');
            list.innerHTML = "<tr><td colspan='3'>Loading...</td></tr>";
            fetch(SCRIPT_URL + "?action=getUsers")
                .then(res => res.json())
                .then(data => {
                    list.innerHTML = "";
                    data.forEach(row => {
                        list.innerHTML += `<tr><td>${row[0]}</td><td>${row[3]}</td><td>${row[6] || 'N/A'}</td></tr>`;
                    });
                })
                .catch(err => { list.innerHTML = "<tr><td colspan='3'>Error loading data.</td></tr>"; });
        }
        window.onload = loadData;
    </script>
</body>
</html>
